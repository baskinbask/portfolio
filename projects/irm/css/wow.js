(function(){var t,e,n,i,o,r=function(t,e){return function(){return t.apply(e,arguments)}},s=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};e=function(){function t(){}return t.prototype.extend=function(t,e){var n,i;for(n in e)i=e[n],null==t[n]&&(t[n]=i);return t},t.prototype.isMobile=function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)},t.prototype.createEvent=function(t,e,n,i){var o;return null==e&&(e=!1),null==n&&(n=!1),null==i&&(i=null),null!=document.createEvent?(o=document.createEvent("CustomEvent"),o.initCustomEvent(t,e,n,i)):null!=document.createEventObject?(o=document.createEventObject(),o.eventType=t):o.eventName=t,o},t.prototype.emitEvent=function(t,e){return null!=t.dispatchEvent?t.dispatchEvent(e):e in(null!=t)?t[e]():"on"+e in(null!=t)?t["on"+e]():void 0},t.prototype.addEvent=function(t,e,n){return null!=t.addEventListener?t.addEventListener(e,n,!1):null!=t.attachEvent?t.attachEvent("on"+e,n):t[e]=n},t.prototype.removeEvent=function(t,e,n){return null!=t.removeEventListener?t.removeEventListener(e,n,!1):null!=t.detachEvent?t.detachEvent("on"+e,n):delete t[e]},t.prototype.innerHeight=function(){return"innerHeight"in window?window.innerHeight:document.documentElement.clientHeight},t}(),n=this.WeakMap||this.MozWeakMap||(n=function(){function t(){this.keys=[],this.values=[]}return t.prototype.get=function(t){var e,n,i,o,r;for(r=this.keys,e=i=0,o=r.length;i<o;e=++i)if(n=r[e],n===t)return this.values[e]},t.prototype.set=function(t,e){var n,i,o,r,s;for(s=this.keys,n=o=0,r=s.length;o<r;n=++o)if(i=s[n],i===t)return void(this.values[n]=e);return this.keys.push(t),this.values.push(e)},t}()),t=this.MutationObserver||this.WebkitMutationObserver||this.MozMutationObserver||(t=function(){function t(){"undefined"!=typeof console&&null!==console&&console.warn("MutationObserver is not supported by your browser."),"undefined"!=typeof console&&null!==console&&console.warn("WOW.js cannot detect dom mutations, please call .sync() after loading new content.")}return t.notSupported=!0,t.prototype.observe=function(){},t}()),i=this.getComputedStyle||function(t,e){return this.getPropertyValue=function(e){var n;return"float"===e&&(e="styleFloat"),o.test(e)&&e.replace(o,function(t,e){return e.toUpperCase()}),(null!=(n=t.currentStyle)?n[e]:void 0)||null},this},o=/(\-([a-z]){1})/g,this.WOW=function(){function o(t){null==t&&(t={}),this.scrollCallback=r(this.scrollCallback,this),this.scrollHandler=r(this.scrollHandler,this),this.resetAnimation=r(this.resetAnimation,this),this.start=r(this.start,this),this.scrolled=!0,this.config=this.util().extend(t,this.defaults),this.animationNameCache=new n,this.wowEvent=this.util().createEvent(this.config.boxClass)}return o.prototype.defaults={boxClass:"wow",animateClass:"animated",offset:0,mobile:!0,live:!0,callback:null},o.prototype.init=function(){var t;return this.element=window.document.documentElement,"interactive"===(t=document.readyState)||"complete"===t?this.start():this.util().addEvent(document,"DOMContentLoaded",this.start),this.finished=[]},o.prototype.start=function(){var e,n,i,o;if(this.stopped=!1,this.boxes=function(){var t,n,i,o;for(i=this.element.querySelectorAll("."+this.config.boxClass),o=[],t=0,n=i.length;t<n;t++)e=i[t],o.push(e);return o}.call(this),this.all=function(){var t,n,i,o;for(i=this.boxes,o=[],t=0,n=i.length;t<n;t++)e=i[t],o.push(e);return o}.call(this),this.boxes.length)if(this.disabled())this.resetStyle();else for(o=this.boxes,n=0,i=o.length;n<i;n++)e=o[n],this.applyStyle(e,!0);if(this.disabled()||(this.util().addEvent(window,"scroll",this.scrollHandler),this.util().addEvent(window,"resize",this.scrollHandler),this.interval=setInterval(this.scrollCallback,50)),this.config.live)return new t(function(t){return function(e){var n,i,o,r,s;for(s=[],n=0,i=e.length;n<i;n++)r=e[n],s.push(function(){var t,e,n,i;for(n=r.addedNodes||[],i=[],t=0,e=n.length;t<e;t++)o=n[t],i.push(this.doSync(o));return i}.call(t));return s}}(this)).observe(document.body,{childList:!0,subtree:!0})},o.prototype.stop=function(){if(this.stopped=!0,this.util().removeEvent(window,"scroll",this.scrollHandler),this.util().removeEvent(window,"resize",this.scrollHandler),null!=this.interval)return clearInterval(this.interval)},o.prototype.sync=function(e){if(t.notSupported)return this.doSync(this.element)},o.prototype.doSync=function(t){var e,n,i,o,r;if(null==t&&(t=this.element),1===t.nodeType){for(t=t.parentNode||t,o=t.querySelectorAll("."+this.config.boxClass),r=[],n=0,i=o.length;n<i;n++)e=o[n],s.call(this.all,e)<0?(this.boxes.push(e),this.all.push(e),this.stopped||this.disabled()?this.resetStyle():this.applyStyle(e,!0),r.push(this.scrolled=!0)):r.push(void 0);return r}},o.prototype.show=function(t){return this.applyStyle(t),t.className=t.className+" "+this.config.animateClass,null!=this.config.callback&&this.config.callback(t),this.util().emitEvent(t,this.wowEvent),this.util().addEvent(t,"animationend",this.resetAnimation),this.util().addEvent(t,"oanimationend",this.resetAnimation),this.util().addEvent(t,"webkitAnimationEnd",this.resetAnimation),this.util().addEvent(t,"MSAnimationEnd",this.resetAnimation),t},o.prototype.applyStyle=function(t,e){var n,i,o;return i=t.getAttribute("data-wow-duration"),n=t.getAttribute("data-wow-delay"),o=t.getAttribute("data-wow-iteration"),this.animate(function(r){return function(){return r.customStyle(t,e,i,n,o)}}(this))},o.prototype.animate=function(){return"requestAnimationFrame"in window?function(t){return window.requestAnimationFrame(t)}:function(t){return t()}}(),o.prototype.resetStyle=function(){var t,e,n,i,o;for(i=this.boxes,o=[],e=0,n=i.length;e<n;e++)t=i[e],o.push(t.style.visibility="visible");return o},o.prototype.resetAnimation=function(t){var e;if(t.type.toLowerCase().indexOf("animationend")>=0)return e=t.target||t.srcElement,e.className=e.className.replace(this.config.animateClass,"").trim()},o.prototype.customStyle=function(t,e,n,i,o){return e&&this.cacheAnimationName(t),t.style.visibility=e?"hidden":"visible",n&&this.vendorSet(t.style,{animationDuration:n}),i&&this.vendorSet(t.style,{animationDelay:i}),o&&this.vendorSet(t.style,{animationIterationCount:o}),this.vendorSet(t.style,{animationName:e?"none":this.cachedAnimationName(t)}),t},o.prototype.vendors=["moz","webkit"],o.prototype.vendorSet=function(t,e){var n,i,o,r;i=[];for(n in e)o=e[n],t[""+n]=o,i.push(function(){var e,i,s,l;for(s=this.vendors,l=[],e=0,i=s.length;e<i;e++)r=s[e],l.push(t[""+r+n.charAt(0).toUpperCase()+n.substr(1)]=o);return l}.call(this));return i},o.prototype.vendorCSS=function(t,e){var n,o,r,s,l,a;for(l=i(t),s=l.getPropertyCSSValue(e),r=this.vendors,n=0,o=r.length;n<o;n++)a=r[n],s=s||l.getPropertyCSSValue("-"+a+"-"+e);return s},o.prototype.animationName=function(t){var e;try{e=this.vendorCSS(t,"animation-name").cssText}catch(n){e=i(t).getPropertyValue("animation-name")}return"none"===e?"":e},o.prototype.cacheAnimationName=function(t){return this.animationNameCache.set(t,this.animationName(t))},o.prototype.cachedAnimationName=function(t){return this.animationNameCache.get(t)},o.prototype.scrollHandler=function(){return this.scrolled=!0},o.prototype.scrollCallback=function(){var t;if(this.scrolled&&(this.scrolled=!1,this.boxes=function(){var e,n,i,o;for(i=this.boxes,o=[],e=0,n=i.length;e<n;e++)t=i[e],t&&(this.isVisible(t)?this.show(t):o.push(t));return o}.call(this),!this.boxes.length&&!this.config.live))return this.stop()},o.prototype.offsetTop=function(t){for(var e;void 0===t.offsetTop;)t=t.parentNode;for(e=t.offsetTop;t=t.offsetParent;)e+=t.offsetTop;return e},o.prototype.isVisible=function(t){var e,n,i,o,r;return n=t.getAttribute("data-wow-offset")||this.config.offset,r=window.pageYOffset,o=r+Math.min(this.element.clientHeight,this.util().innerHeight())-n,i=this.offsetTop(t),e=i+t.clientHeight,i<=o&&e>=r},o.prototype.util=function(){return null!=this._util?this._util:this._util=new e},o.prototype.disabled=function(){return!this.config.mobile&&this.util().isMobile(navigator.userAgent)},o}()}).call(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndvdy5qcyJdLCJuYW1lcyI6WyJNdXRhdGlvbk9ic2VydmVyIiwiVXRpbCIsIldlYWtNYXAiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0Q29tcHV0ZWRTdHlsZVJYIiwiYmluZCIsImZuIiwibWUiLCJhcHBseSIsImFyZ3VtZW50cyIsImluZGV4T2YiLCJpdGVtIiwiaSIsImwiLCJ0aGlzIiwibGVuZ3RoIiwicHJvdG90eXBlIiwiZXh0ZW5kIiwiY3VzdG9tIiwiZGVmYXVsdHMiLCJrZXkiLCJ2YWx1ZSIsImlzTW9iaWxlIiwiYWdlbnQiLCJ0ZXN0IiwiY3JlYXRlRXZlbnQiLCJldmVudCIsImJ1YmJsZSIsImNhbmNlbCIsImRldGFpbCIsImN1c3RvbUV2ZW50IiwiZG9jdW1lbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJjcmVhdGVFdmVudE9iamVjdCIsImV2ZW50VHlwZSIsImV2ZW50TmFtZSIsImVtaXRFdmVudCIsImVsZW0iLCJkaXNwYXRjaEV2ZW50IiwiYWRkRXZlbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiYXR0YWNoRXZlbnQiLCJyZW1vdmVFdmVudCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJkZXRhY2hFdmVudCIsImlubmVySGVpZ2h0Iiwid2luZG93IiwiZG9jdW1lbnRFbGVtZW50IiwiY2xpZW50SGVpZ2h0IiwiTW96V2Vha01hcCIsImtleXMiLCJ2YWx1ZXMiLCJnZXQiLCJqIiwibGVuIiwicmVmIiwic2V0IiwicHVzaCIsIldlYmtpdE11dGF0aW9uT2JzZXJ2ZXIiLCJNb3pNdXRhdGlvbk9ic2VydmVyIiwiY29uc29sZSIsIndhcm4iLCJub3RTdXBwb3J0ZWQiLCJvYnNlcnZlIiwiZWwiLCJwc2V1ZG8iLCJnZXRQcm9wZXJ0eVZhbHVlIiwicHJvcCIsInJlcGxhY2UiLCJfIiwiX2NoYXIiLCJ0b1VwcGVyQ2FzZSIsImN1cnJlbnRTdHlsZSIsIldPVyIsIm9wdGlvbnMiLCJzY3JvbGxDYWxsYmFjayIsInNjcm9sbEhhbmRsZXIiLCJyZXNldEFuaW1hdGlvbiIsInN0YXJ0Iiwic2Nyb2xsZWQiLCJjb25maWciLCJ1dGlsIiwiYW5pbWF0aW9uTmFtZUNhY2hlIiwid293RXZlbnQiLCJib3hDbGFzcyIsImFuaW1hdGVDbGFzcyIsIm9mZnNldCIsIm1vYmlsZSIsImxpdmUiLCJjYWxsYmFjayIsImluaXQiLCJlbGVtZW50IiwicmVhZHlTdGF0ZSIsImZpbmlzaGVkIiwiYm94Iiwic3RvcHBlZCIsImJveGVzIiwicmVzdWx0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjYWxsIiwiYWxsIiwiZGlzYWJsZWQiLCJyZXNldFN0eWxlIiwiYXBwbHlTdHlsZSIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJfdGhpcyIsInJlY29yZHMiLCJrIiwibGVuMSIsIm5vZGUiLCJyZWNvcmQiLCJsZW4yIiwicmVmMSIsInJlc3VsdHMxIiwiYWRkZWROb2RlcyIsImRvU3luYyIsImJvZHkiLCJjaGlsZExpc3QiLCJzdWJ0cmVlIiwic3RvcCIsImNsZWFySW50ZXJ2YWwiLCJzeW5jIiwibm9kZVR5cGUiLCJwYXJlbnROb2RlIiwic2hvdyIsImNsYXNzTmFtZSIsImhpZGRlbiIsImRlbGF5IiwiZHVyYXRpb24iLCJpdGVyYXRpb24iLCJnZXRBdHRyaWJ1dGUiLCJhbmltYXRlIiwiY3VzdG9tU3R5bGUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJ0YXJnZXQiLCJ0eXBlIiwidG9Mb3dlckNhc2UiLCJzcmNFbGVtZW50IiwidHJpbSIsImNhY2hlQW5pbWF0aW9uTmFtZSIsInZlbmRvclNldCIsImFuaW1hdGlvbkR1cmF0aW9uIiwiYW5pbWF0aW9uRGVsYXkiLCJhbmltYXRpb25JdGVyYXRpb25Db3VudCIsImFuaW1hdGlvbk5hbWUiLCJjYWNoZWRBbmltYXRpb25OYW1lIiwidmVuZG9ycyIsInByb3BlcnRpZXMiLCJuYW1lIiwidmVuZG9yIiwiY2hhckF0Iiwic3Vic3RyIiwidmVuZG9yQ1NTIiwicHJvcGVydHkiLCJyZXN1bHQiLCJnZXRQcm9wZXJ0eUNTU1ZhbHVlIiwiY3NzVGV4dCIsIl9lcnJvciIsImlzVmlzaWJsZSIsIm9mZnNldFRvcCIsInRvcCIsIm9mZnNldFBhcmVudCIsImJvdHRvbSIsInZpZXdCb3R0b20iLCJ2aWV3VG9wIiwicGFnZVlPZmZzZXQiLCJNYXRoIiwibWluIiwiX3V0aWwiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0UsR0FBSUEsR0FBa0JDLEVBQU1DLEVBQVNDLEVBQWtCQyxFQUNyREMsRUFBTyxTQUFTQyxFQUFJQyxHQUFLLE1BQU8sWUFBWSxNQUFPRCxHQUFHRSxNQUFNRCxFQUFJRSxhQUNoRUMsS0FBYUEsU0FBVyxTQUFTQyxHQUFRLElBQUssR0FBSUMsR0FBSSxFQUFHQyxFQUFJQyxLQUFLQyxPQUFRSCxFQUFJQyxFQUFHRCxJQUFPLEdBQUlBLElBQUtFLE9BQVFBLEtBQUtGLEtBQU9ELEVBQU0sTUFBT0MsRUFBSyxVQUV6SVgsR0FBTyxXQUNMLFFBQVNBLE1BOEVULE1BNUVBQSxHQUFLZSxVQUFVQyxPQUFTLFNBQVNDLEVBQVFDLEdBQ3ZDLEdBQUlDLEdBQUtDLENBQ1QsS0FBS0QsSUFBT0QsR0FDVkUsRUFBUUYsRUFBU0MsR0FDRSxNQUFmRixFQUFPRSxLQUNURixFQUFPRSxHQUFPQyxFQUdsQixPQUFPSCxJQUdUakIsRUFBS2UsVUFBVU0sU0FBVyxTQUFTQyxHQUNqQyxNQUFPLGlFQUFpRUMsS0FBS0QsSUFHL0V0QixFQUFLZSxVQUFVUyxZQUFjLFNBQVNDLEVBQU9DLEVBQVFDLEVBQVFDLEdBQzNELEdBQUlDLEVBbUJKLE9BbEJjLE9BQVZILElBQ0ZBLEdBQVMsR0FFRyxNQUFWQyxJQUNGQSxHQUFTLEdBRUcsTUFBVkMsSUFDRkEsRUFBUyxNQUVpQixNQUF4QkUsU0FBU04sYUFDWEssRUFBY0MsU0FBU04sWUFBWSxlQUNuQ0ssRUFBWUUsZ0JBQWdCTixFQUFPQyxFQUFRQyxFQUFRQyxJQUNaLE1BQTlCRSxTQUFTRSxtQkFDbEJILEVBQWNDLFNBQVNFLG9C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LE9BQWRuRSxLQUFLNkosTUFBZ0I3SixLQUFLNkosTUFBUTdKLEtBQUs2SixNQUFRLEdBQUkxSyxJQUc1RHdFLEVBQUl6RCxVQUFVcUYsU0FBVyxXQUN2QixPQUFRdkYsS0FBS2tFLE9BQU9PLFFBQVV6RSxLQUFLbUUsT0FBTzNELFNBQVNzSixVQUFVQyxZQUd4RHBHLE9BSVIwQixLQUFLckYiLCJmaWxlIjoid293LmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuICB2YXIgTXV0YXRpb25PYnNlcnZlciwgVXRpbCwgV2Vha01hcCwgZ2V0Q29tcHV0ZWRTdHlsZSwgZ2V0Q29tcHV0ZWRTdHlsZVJYLFxuICAgIGJpbmQgPSBmdW5jdGlvbihmbiwgbWUpeyByZXR1cm4gZnVuY3Rpb24oKXsgcmV0dXJuIGZuLmFwcGx5KG1lLCBhcmd1bWVudHMpOyB9OyB9LFxuICAgIGluZGV4T2YgPSBbXS5pbmRleE9mIHx8IGZ1bmN0aW9uKGl0ZW0pIHsgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykgeyBpZiAoaSBpbiB0aGlzICYmIHRoaXNbaV0gPT09IGl0ZW0pIHJldHVybiBpOyB9IHJldHVybiAtMTsgfTtcblxuICBVdGlsID0gKGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIFV0aWwoKSB7fVxuXG4gICAgVXRpbC5wcm90b3R5cGUuZXh0ZW5kID0gZnVuY3Rpb24oY3VzdG9tLCBkZWZhdWx0cykge1xuICAgICAgdmFyIGtleSwgdmFsdWU7XG4gICAgICBmb3IgKGtleSBpbiBkZWZhdWx0cykge1xuICAgICAgICB2YWx1ZSA9IGRlZmF1bHRzW2tleV07XG4gICAgICAgIGlmIChjdXN0b21ba2V5XSA9PSBudWxsKSB7XG4gICAgICAgICAgY3VzdG9tW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGN1c3RvbTtcbiAgICB9O1xuXG4gICAgVXRpbC5wcm90b3R5cGUuaXNNb2JpbGUgPSBmdW5jdGlvbihhZ2VudCkge1xuICAgICAgcmV0dXJuIC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChhZ2VudCk7XG4gICAgfTtcblxuICAgIFV0aWwucHJvdG90eXBlLmNyZWF0ZUV2ZW50ID0gZnVuY3Rpb24oZXZlbnQsIGJ1YmJsZSwgY2FuY2VsLCBkZXRhaWwpIHtcbiAgICAgIHZhciBjdXN0b21FdmVudDtcbiAgICAgIGlmIChidWJibGUgPT0gbnVsbCkge1xuICAgICAgICBidWJibGUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChjYW5jZWwgPT0gbnVsbCkge1xuICAgICAgICBjYW5jZWwgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChkZXRhaWwgPT0gbnVsbCkge1xuICAgICAgICBkZXRhaWwgPSBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKGRvY3VtZW50LmNyZWF0ZUV2ZW50ICE9IG51bGwpIHtcbiAgICAgICAgY3VzdG9tRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICAgICAgY3VzdG9tRXZlbnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50LCBidWJibGUsIGNhbmNlbCwgZGV0YWlsKTtcbiAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QgIT0gbnVsbCkge1xuICAgICAgICBjdXN0b21FdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG4gICAgICAgIGN1c3RvbUV2ZW50LmV2ZW50VHlwZSA9IGV2ZW50O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VzdG9tRXZlbnQuZXZlbnROYW1lID0gZXZlbnQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gY3VzdG9tRXZlbnQ7XG4gICAgfTtcblxuICAgIFV0aWwucHJvdG90eXBlLmVtaXRFdmVudCA9IGZ1bmN0aW9uKGVsZW0sIGV2ZW50KSB7XG4gICAgICBpZiAoZWxlbS5kaXNwYXRjaEV2ZW50ICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGVsZW0uZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICB9IGVsc2UgaWYgKGV2ZW50IGluIChlbGVtICE9IG51bGwpKSB7XG4gICAgICAgIHJldHVybiBlbGVtW2V2ZW50XSgpO1xuICAgICAgfSBlbHNlIGlmICgoXCJvblwiICsgZXZlbnQpIGluIChlbGVtICE9IG51bGwpKSB7XG4gICAgICAgIHJldHVybiBlbGVtW1wib25cIiArIGV2ZW50XSgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBVdGlsLnByb3RvdHlwZS5hZGRFdmVudCA9IGZ1bmN0aW9uKGVsZW0sIGV2ZW50LCBmbikge1xuICAgICAgaWYgKGVsZW0uYWRkRXZlbnRMaXN0ZW5lciAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZuLCBmYWxzZSk7XG4gICAgICB9IGVsc2UgaWYgKGVsZW0uYXR0YWNoRXZlbnQgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZWxlbS5hdHRhY2hFdmVudChcIm9uXCIgKyBldmVudCwgZm4pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGVsZW1bZXZlbnRdID0gZm47XG4gICAgICB9XG4gICAgfTtcblxuICAgIFV0aWwucHJvdG90eXBlLnJlbW92ZUV2ZW50ID0gZnVuY3Rpb24oZWxlbSwgZXZlbnQsIGZuKSB7XG4gICAgICBpZiAoZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgZm4sIGZhbHNlKTtcbiAgICAgIH0gZWxzZSBpZiAoZWxlbS5kZXRhY2hFdmVudCAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBlbGVtLmRldGFjaEV2ZW50KFwib25cIiArIGV2ZW50LCBmbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZGVsZXRlIGVsZW1bZXZlbnRdO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBVdGlsLnByb3RvdHlwZS5pbm5lckhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCdpbm5lckhlaWdodCcgaW4gd2luZG93KSB7XG4gICAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIFV0aWw7XG5cbiAgfSkoKTtcblxuICBXZWFrTWFwID0gdGhpcy5XZWFrTWFwIHx8IHRoaXMuTW96V2Vha01hcCB8fCAoV2Vha01hcCA9IChmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBXZWFrTWFwKCkge1xuICAgICAgdGhpcy5rZXlzID0gW107XG4gICAgICB0aGlzLnZhbHVlcyA9IFtdO1xuICAgIH1cblxuICAgIFdlYWtNYXAucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIGksIGl0ZW0sIGosIGxlbiwgcmVmO1xuICAgICAgcmVmID0gdGhpcy5rZXlzO1xuICAgICAgZm9yIChpID0gaiA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGogPCBsZW47IGkgPSArK2opIHtcbiAgICAgICAgaXRlbSA9IHJlZltpXTtcbiAgICAgICAgaWYgKGl0ZW0gPT09IGtleSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlc1tpXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICBXZWFrTWFwLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICB2YXIgaSwgaXRlbSwgaiwgbGVuLCByZWY7XG4gICAgICByZWYgPSB0aGlzLmtleXM7XG4gICAgICBmb3IgKGkgPSBqID0gMCwgbGVuID0gcmVmLmxlbmd0aDsgaiA8IGxlbjsgaSA9ICsraikge1xuICAgICAgICBpdGVtID0gcmVmW2ldO1xuICAgICAgICBpZiAoaXRlbSA9PT0ga2V5KSB7XG4gICAgICAgICAgdGhpcy52YWx1ZXNbaV0gPSB2YWx1ZTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMua2V5cy5wdXNoKGtleSk7XG4gICAgICByZXR1cm4gdGhpcy52YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgfTtcblxuICAgIHJldHVybiBXZWFrTWFwO1xuXG4gIH0pKCkpO1xuXG4gIE11dGF0aW9uT2JzZXJ2ZXIgPSB0aGlzLk11dGF0aW9uT2JzZXJ2ZXIgfHwgdGhpcy5XZWJraXRNdXRhdGlvbk9ic2VydmVyIHx8IHRoaXMuTW96TXV0YXRpb25PYnNlcnZlciB8fCAoTXV0YXRpb25PYnNlcnZlciA9IChmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBNdXRhdGlvbk9ic2VydmVyKCkge1xuICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSBcInVuZGVmaW5lZFwiICYmIGNvbnNvbGUgIT09IG51bGwpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdNdXRhdGlvbk9ic2VydmVyIGlzIG5vdCBzdXBwb3J0ZWQgYnkgeW91ciBicm93c2VyLicpO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSBcInVuZGVmaW5lZFwiICYmIGNvbnNvbGUgIT09IG51bGwpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdXT1cuanMgY2Fubm90IGRldGVjdCBkb20gbXV0YXRpb25zLCBwbGVhc2UgY2FsbCAuc3luYygpIGFmdGVyIGxvYWRpbmcgbmV3IGNvbnRlbnQuJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgTXV0YXRpb25PYnNlcnZlci5ub3RTdXBwb3J0ZWQgPSB0cnVlO1xuXG4gICAgTXV0YXRpb25PYnNlcnZlci5wcm90b3R5cGUub2JzZXJ2ZSA9IGZ1bmN0aW9uKCkge307XG5cbiAgICByZXR1cm4gTXV0YXRpb25PYnNlcnZlcjtcblxuICB9KSgpKTtcblxuICBnZXRDb21wdXRlZFN0eWxlID0gdGhpcy5nZXRDb21wdXRlZFN0eWxlIHx8IGZ1bmN0aW9uKGVsLCBwc2V1ZG8pIHtcbiAgICB0aGlzLmdldFByb3BlcnR5VmFsdWUgPSBmdW5jdGlvbihwcm9wKSB7XG4gICAgICB2YXIgcmVmO1xuICAgICAgaWYgKHByb3AgPT09ICdmbG9hdCcpIHtcbiAgICAgICAgcHJvcCA9ICdzdHlsZUZsb2F0JztcbiAgICAgIH1cbiAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlUlgudGVzdChwcm9wKSkge1xuICAgICAgICBwcm9wLnJlcGxhY2UoZ2V0Q29tcHV0ZWRTdHlsZVJYLCBmdW5jdGlvbihfLCBfY2hhcikge1xuICAgICAgICAgIHJldHVybiBfY2hhci50b1VwcGVyQ2FzZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAoKHJlZiA9IGVsLmN1cnJlbnRTdHlsZSkgIT0gbnVsbCA/IHJlZltwcm9wXSA6IHZvaWQgMCkgfHwgbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIGdldENvbXB1dGVkU3R5bGVSWCA9IC8oXFwtKFthLXpdKXsxfSkvZztcblxuICB0aGlzLldPVyA9IChmdW5jdGlvbigpIHtcbiAgICBXT1cucHJvdG90eXBlLmRlZmF1bHRzID0ge1xuICAgICAgYm94Q2xhc3M6ICd3b3cnLFxuICAgICAgYW5pbWF0ZUNsYXNzOiAnYW5pbWF0ZWQnLFxuICAgICAgb2Zmc2V0OiAwLFxuICAgICAgbW9iaWxlOiB0cnVlLFxuICAgICAgbGl2ZTogdHJ1ZSxcbiAgICAgIGNhbGxiYWNrOiBudWxsXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFdPVyhvcHRpb25zKSB7XG4gICAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XG4gICAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc2Nyb2xsQ2FsbGJhY2sgPSBiaW5kKHRoaXMuc2Nyb2xsQ2FsbGJhY2ssIHRoaXMpO1xuICAgICAgdGhpcy5zY3JvbGxIYW5kbGVyID0gYmluZCh0aGlzLnNjcm9sbEhhbmRsZXIsIHRoaXMpO1xuICAgICAgdGhpcy5yZXNldEFuaW1hdGlvbiA9IGJpbmQodGhpcy5yZXNldEFuaW1hdGlvbiwgdGhpcyk7XG4gICAgICB0aGlzLnN0YXJ0ID0gYmluZCh0aGlzLnN0YXJ0LCB0aGlzKTtcbiAgICAgIHRoaXMuc2Nyb2xsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5jb25maWcgPSB0aGlzLnV0aWwoKS5leHRlbmQob3B0aW9ucywgdGhpcy5kZWZhdWx0cyk7XG4gICAgICB0aGlzLmFuaW1hdGlvbk5hbWVDYWNoZSA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICB0aGlzLndvd0V2ZW50ID0gdGhpcy51dGlsKCkuY3JlYXRlRXZlbnQodGhpcy5jb25maWcuYm94Q2xhc3MpO1xuICAgIH1cblxuICAgIFdPVy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlZjtcbiAgICAgIHRoaXMuZWxlbWVudCA9IHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICBpZiAoKHJlZiA9IGRvY3VtZW50LnJlYWR5U3RhdGUpID09PSBcImludGVyYWN0aXZlXCIgfHwgcmVmID09PSBcImNvbXBsZXRlXCIpIHtcbiAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy51dGlsKCkuYWRkRXZlbnQoZG9jdW1lbnQsICdET01Db250ZW50TG9hZGVkJywgdGhpcy5zdGFydCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5maW5pc2hlZCA9IFtdO1xuICAgIH07XG5cbiAgICBXT1cucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYm94LCBqLCBsZW4sIHJlZjtcbiAgICAgIHRoaXMuc3RvcHBlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5ib3hlcyA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGosIGxlbiwgcmVmLCByZXN1bHRzO1xuICAgICAgICByZWYgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5cIiArIHRoaXMuY29uZmlnLmJveENsYXNzKTtcbiAgICAgICAgcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKGogPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICBib3ggPSByZWZbal07XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKGJveCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5hbGwgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBqLCBsZW4sIHJlZiwgcmVzdWx0cztcbiAgICAgICAgcmVmID0gdGhpcy5ib3hlcztcbiAgICAgICAgcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKGogPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICBib3ggPSByZWZbal07XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKGJveCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgaWYgKHRoaXMuYm94ZXMubGVuZ3RoKSB7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkKCkpIHtcbiAgICAgICAgICB0aGlzLnJlc2V0U3R5bGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWYgPSB0aGlzLmJveGVzO1xuICAgICAgICAgIGZvciAoaiA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGogPCBsZW47IGorKykge1xuICAgICAgICAgICAgYm94ID0gcmVmW2pdO1xuICAgICAgICAgICAgdGhpcy5hcHBseVN0eWxlKGJveCwgdHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIXRoaXMuZGlzYWJsZWQoKSkge1xuICAgICAgICB0aGlzLnV0aWwoKS5hZGRFdmVudCh3aW5kb3csICdzY3JvbGwnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xuICAgICAgICB0aGlzLnV0aWwoKS5hZGRFdmVudCh3aW5kb3csICdyZXNpemUnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xuICAgICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5zY3JvbGxDYWxsYmFjaywgNTApO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuY29uZmlnLmxpdmUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNdXRhdGlvbk9ic2VydmVyKChmdW5jdGlvbihfdGhpcykge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbihyZWNvcmRzKSB7XG4gICAgICAgICAgICB2YXIgaywgbGVuMSwgbm9kZSwgcmVjb3JkLCByZXN1bHRzO1xuICAgICAgICAgICAgcmVzdWx0cyA9IFtdO1xuICAgICAgICAgICAgZm9yIChrID0gMCwgbGVuMSA9IHJlY29yZHMubGVuZ3RoOyBrIDwgbGVuMTsgaysrKSB7XG4gICAgICAgICAgICAgIHJlY29yZCA9IHJlY29yZHNba107XG4gICAgICAgICAgICAgIHJlc3VsdHMucHVzaCgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGwsIGxlbjIsIHJlZjEsIHJlc3VsdHMxO1xuICAgICAgICAgICAgICAgIHJlZjEgPSByZWNvcmQuYWRkZWROb2RlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICByZXN1bHRzMSA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAobCA9IDAsIGxlbjIgPSByZWYxLmxlbmd0aDsgbCA8IGxlbjI7IGwrKykge1xuICAgICAgICAgICAgICAgICAgbm9kZSA9IHJlZjFbbF07XG4gICAgICAgICAgICAgICAgICByZXN1bHRzMS5wdXNoKHRoaXMuZG9TeW5jKG5vZGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHMxO1xuICAgICAgICAgICAgICB9KS5jYWxsKF90aGlzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgICAgICB9O1xuICAgICAgICB9KSh0aGlzKSkub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7XG4gICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICAgIHN1YnRyZWU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIFdPVy5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5zdG9wcGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMudXRpbCgpLnJlbW92ZUV2ZW50KHdpbmRvdywgJ3Njcm9sbCcsIHRoaXMuc2Nyb2xsSGFuZGxlcik7XG4gICAgICB0aGlzLnV0aWwoKS5yZW1vdmVFdmVudCh3aW5kb3csICdyZXNpemUnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xuICAgICAgaWYgKHRoaXMuaW50ZXJ2YWwgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgV09XLnByb3RvdHlwZS5zeW5jID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgaWYgKE11dGF0aW9uT2JzZXJ2ZXIubm90U3VwcG9ydGVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvU3luYyh0aGlzLmVsZW1lbnQpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBXT1cucHJvdG90eXBlLmRvU3luYyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgIHZhciBib3gsIGosIGxlbiwgcmVmLCByZXN1bHRzO1xuICAgICAgaWYgKGVsZW1lbnQgPT0gbnVsbCkge1xuICAgICAgICBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuICAgICAgfVxuICAgICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgIT09IDEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZSB8fCBlbGVtZW50O1xuICAgICAgcmVmID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLlwiICsgdGhpcy5jb25maWcuYm94Q2xhc3MpO1xuICAgICAgcmVzdWx0cyA9IFtdO1xuICAgICAgZm9yIChqID0gMCwgbGVuID0gcmVmLmxlbmd0aDsgaiA8IGxlbjsgaisrKSB7XG4gICAgICAgIGJveCA9IHJlZltqXTtcbiAgICAgICAgaWYgKGluZGV4T2YuY2FsbCh0aGlzLmFsbCwgYm94KSA8IDApIHtcbiAgICAgICAgICB0aGlzLmJveGVzLnB1c2goYm94KTtcbiAgICAgICAgICB0aGlzLmFsbC5wdXNoKGJveCk7XG4gICAgICAgICAgaWYgKHRoaXMuc3RvcHBlZCB8fCB0aGlzLmRpc2FibGVkKCkpIHtcbiAgICAgICAgICAgIHRoaXMucmVzZXRTdHlsZSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFwcGx5U3R5bGUoYm94LCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHRoaXMuc2Nyb2xsZWQgPSB0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXN1bHRzLnB1c2godm9pZCAwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfTtcblxuICAgIFdPVy5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uKGJveCkge1xuICAgICAgdGhpcy5hcHBseVN0eWxlKGJveCk7XG4gICAgICBib3guY2xhc3NOYW1lID0gYm94LmNsYXNzTmFtZSArIFwiIFwiICsgdGhpcy5jb25maWcuYW5pbWF0ZUNsYXNzO1xuICAgICAgaWYgKHRoaXMuY29uZmlnLmNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5jb25maWcuY2FsbGJhY2soYm94KTtcbiAgICAgIH1cbiAgICAgIHRoaXMudXRpbCgpLmVtaXRFdmVudChib3gsIHRoaXMud293RXZlbnQpO1xuICAgICAgdGhpcy51dGlsKCkuYWRkRXZlbnQoYm94LCAnYW5pbWF0aW9uZW5kJywgdGhpcy5yZXNldEFuaW1hdGlvbik7XG4gICAgICB0aGlzLnV0aWwoKS5hZGRFdmVudChib3gsICdvYW5pbWF0aW9uZW5kJywgdGhpcy5yZXNldEFuaW1hdGlvbik7XG4gICAgICB0aGlzLnV0aWwoKS5hZGRFdmVudChib3gsICd3ZWJraXRBbmltYXRpb25FbmQnLCB0aGlzLnJlc2V0QW5pbWF0aW9uKTtcbiAgICAgIHRoaXMudXRpbCgpLmFkZEV2ZW50KGJveCwgJ01TQW5pbWF0aW9uRW5kJywgdGhpcy5yZXNldEFuaW1hdGlvbik7XG4gICAgICByZXR1cm4gYm94O1xuICAgIH07XG5cbiAgICBXT1cucHJvdG90eXBlLmFwcGx5U3R5bGUgPSBmdW5jdGlvbihib3gsIGhpZGRlbikge1xuICAgICAgdmFyIGRlbGF5LCBkdXJhdGlvbiwgaXRlcmF0aW9uO1xuICAgICAgZHVyYXRpb24gPSBib3guZ2V0QXR0cmlidXRlKCdkYXRhLXdvdy1kdXJhdGlvbicpO1xuICAgICAgZGVsYXkgPSBib3guZ2V0QXR0cmlidXRlKCdkYXRhLXdvdy1kZWxheScpO1xuICAgICAgaXRlcmF0aW9uID0gYm94LmdldEF0dHJpYnV0ZSgnZGF0YS13b3ctaXRlcmF0aW9uJyk7XG4gICAgICByZXR1cm4gdGhpcy5hbmltYXRlKChmdW5jdGlvbihfdGhpcykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzLmN1c3RvbVN0eWxlKGJveCwgaGlkZGVuLCBkdXJhdGlvbiwgZGVsYXksIGl0ZXJhdGlvbik7XG4gICAgICAgIH07XG4gICAgICB9KSh0aGlzKSk7XG4gICAgfTtcblxuICAgIFdPVy5wcm90b3R5cGUuYW5pbWF0ZSA9IChmdW5jdGlvbigpIHtcbiAgICAgIGlmICgncmVxdWVzdEFuaW1hdGlvbkZyYW1lJyBpbiB3aW5kb3cpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgICAgcmV0dXJuIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2FsbGJhY2spO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSkoKTtcblxuICAgIFdPVy5wcm90b3R5cGUucmVzZXRTdHlsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGJveCwgaiwgbGVuLCByZWYsIHJlc3VsdHM7XG4gICAgICByZWYgPSB0aGlzLmJveGVzO1xuICAgICAgcmVzdWx0cyA9IFtdO1xuICAgICAgZm9yIChqID0gMCwgbGVuID0gcmVmLmxlbmd0aDsgaiA8IGxlbjsgaisrKSB7XG4gICAgICAgIGJveCA9IHJlZltqXTtcbiAgICAgICAgcmVzdWx0cy5wdXNoKGJveC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH07XG5cbiAgICBXT1cucHJvdG90eXBlLnJlc2V0QW5pbWF0aW9uID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHZhciB0YXJnZXQ7XG4gICAgICBpZiAoZXZlbnQudHlwZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2FuaW1hdGlvbmVuZCcpID49IDApIHtcbiAgICAgICAgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7XG4gICAgICAgIHJldHVybiB0YXJnZXQuY2xhc3NOYW1lID0gdGFyZ2V0LmNsYXNzTmFtZS5yZXBsYWNlKHRoaXMuY29uZmlnLmFuaW1hdGVDbGFzcywgJycpLnRyaW0oKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgV09XLnByb3RvdHlwZS5jdXN0b21TdHlsZSA9IGZ1bmN0aW9uKGJveCwgaGlkZGVuLCBkdXJhdGlvbiwgZGVsYXksIGl0ZXJhdGlvbikge1xuICAgICAgaWYgKGhpZGRlbikge1xuICAgICAgICB0aGlzLmNhY2hlQW5pbWF0aW9uTmFtZShib3gpO1xuICAgICAgfVxuICAgICAgYm94LnN0eWxlLnZpc2liaWxpdHkgPSBoaWRkZW4gPyAnaGlkZGVuJyA6ICd2aXNpYmxlJztcbiAgICAgIGlmIChkdXJhdGlvbikge1xuICAgICAgICB0aGlzLnZlbmRvclNldChib3guc3R5bGUsIHtcbiAgICAgICAgICBhbmltYXRpb25EdXJhdGlvbjogZHVyYXRpb25cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoZGVsYXkpIHtcbiAgICAgICAgdGhpcy52ZW5kb3JTZXQoYm94LnN0eWxlLCB7XG4gICAgICAgICAgYW5pbWF0aW9uRGVsYXk6IGRlbGF5XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGl0ZXJhdGlvbikge1xuICAgICAgICB0aGlzLnZlbmRvclNldChib3guc3R5bGUsIHtcbiAgICAgICAgICBhbmltYXRpb25JdGVyYXRpb25Db3VudDogaXRlcmF0aW9uXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy52ZW5kb3JTZXQoYm94LnN0eWxlLCB7XG4gICAgICAgIGFuaW1hdGlvbk5hbWU6IGhpZGRlbiA/ICdub25lJyA6IHRoaXMuY2FjaGVkQW5pbWF0aW9uTmFtZShib3gpXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBib3g7XG4gICAgfTtcblxuICAgIFdPVy5wcm90b3R5cGUudmVuZG9ycyA9IFtcIm1velwiLCBcIndlYmtpdFwiXTtcblxuICAgIFdPVy5wcm90b3R5cGUudmVuZG9yU2V0ID0gZnVuY3Rpb24oZWxlbSwgcHJvcGVydGllcykge1xuICAgICAgdmFyIG5hbWUsIHJlc3VsdHMsIHZhbHVlLCB2ZW5kb3I7XG4gICAgICByZXN1bHRzID0gW107XG4gICAgICBmb3IgKG5hbWUgaW4gcHJvcGVydGllcykge1xuICAgICAgICB2YWx1ZSA9IHByb3BlcnRpZXNbbmFtZV07XG4gICAgICAgIGVsZW1bXCJcIiArIG5hbWVdID0gdmFsdWU7XG4gICAgICAgIHJlc3VsdHMucHVzaCgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGosIGxlbiwgcmVmLCByZXN1bHRzMTtcbiAgICAgICAgICByZWYgPSB0aGlzLnZlbmRvcnM7XG4gICAgICAgICAgcmVzdWx0czEgPSBbXTtcbiAgICAgICAgICBmb3IgKGogPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICAgIHZlbmRvciA9IHJlZltqXTtcbiAgICAgICAgICAgIHJlc3VsdHMxLnB1c2goZWxlbVtcIlwiICsgdmVuZG9yICsgKG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkpICsgKG5hbWUuc3Vic3RyKDEpKV0gPSB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHRzMTtcbiAgICAgICAgfSkuY2FsbCh0aGlzKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9O1xuXG4gICAgV09XLnByb3RvdHlwZS52ZW5kb3JDU1MgPSBmdW5jdGlvbihlbGVtLCBwcm9wZXJ0eSkge1xuICAgICAgdmFyIGosIGxlbiwgcmVmLCByZXN1bHQsIHN0eWxlLCB2ZW5kb3I7XG4gICAgICBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbSk7XG4gICAgICByZXN1bHQgPSBzdHlsZS5nZXRQcm9wZXJ0eUNTU1ZhbHVlKHByb3BlcnR5KTtcbiAgICAgIHJlZiA9IHRoaXMudmVuZG9ycztcbiAgICAgIGZvciAoaiA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGogPCBsZW47IGorKykge1xuICAgICAgICB2ZW5kb3IgPSByZWZbal07XG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCB8fCBzdHlsZS5nZXRQcm9wZXJ0eUNTU1ZhbHVlKFwiLVwiICsgdmVuZG9yICsgXCItXCIgKyBwcm9wZXJ0eSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICBXT1cucHJvdG90eXBlLmFuaW1hdGlvbk5hbWUgPSBmdW5jdGlvbihib3gpIHtcbiAgICAgIHZhciBhbmltYXRpb25OYW1lO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYW5pbWF0aW9uTmFtZSA9IHRoaXMudmVuZG9yQ1NTKGJveCwgJ2FuaW1hdGlvbi1uYW1lJykuY3NzVGV4dDtcbiAgICAgIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgICAgICBhbmltYXRpb25OYW1lID0gZ2V0Q29tcHV0ZWRTdHlsZShib3gpLmdldFByb3BlcnR5VmFsdWUoJ2FuaW1hdGlvbi1uYW1lJyk7XG4gICAgICB9XG4gICAgICBpZiAoYW5pbWF0aW9uTmFtZSA9PT0gJ25vbmUnKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25OYW1lO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBXT1cucHJvdG90eXBlLmNhY2hlQW5pbWF0aW9uTmFtZSA9IGZ1bmN0aW9uKGJveCkge1xuICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9uTmFtZUNhY2hlLnNldChib3gsIHRoaXMuYW5pbWF0aW9uTmFtZShib3gpKTtcbiAgICB9O1xuXG4gICAgV09XLnByb3RvdHlwZS5jYWNoZWRBbmltYXRpb25OYW1lID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICByZXR1cm4gdGhpcy5hbmltYXRpb25OYW1lQ2FjaGUuZ2V0KGJveCk7XG4gICAgfTtcblxuICAgIFdPVy5wcm90b3R5cGUuc2Nyb2xsSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuc2Nyb2xsZWQgPSB0cnVlO1xuICAgIH07XG5cbiAgICBXT1cucHJvdG90eXBlLnNjcm9sbENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYm94O1xuICAgICAgaWYgKHRoaXMuc2Nyb2xsZWQpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJveGVzID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBqLCBsZW4sIHJlZiwgcmVzdWx0cztcbiAgICAgICAgICByZWYgPSB0aGlzLmJveGVzO1xuICAgICAgICAgIHJlc3VsdHMgPSBbXTtcbiAgICAgICAgICBmb3IgKGogPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICAgIGJveCA9IHJlZltqXTtcbiAgICAgICAgICAgIGlmICghKGJveCkpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5pc1Zpc2libGUoYm94KSkge1xuICAgICAgICAgICAgICB0aGlzLnNob3coYm94KTtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHRzLnB1c2goYm94KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgIGlmICghKHRoaXMuYm94ZXMubGVuZ3RoIHx8IHRoaXMuY29uZmlnLmxpdmUpKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIFdPVy5wcm90b3R5cGUub2Zmc2V0VG9wID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgdmFyIHRvcDtcbiAgICAgIHdoaWxlIChlbGVtZW50Lm9mZnNldFRvcCA9PT0gdm9pZCAwKSB7XG4gICAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICB9XG4gICAgICB0b3AgPSBlbGVtZW50Lm9mZnNldFRvcDtcbiAgICAgIHdoaWxlIChlbGVtZW50ID0gZWxlbWVudC5vZmZzZXRQYXJlbnQpIHtcbiAgICAgICAgdG9wICs9IGVsZW1lbnQub2Zmc2V0VG9wO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRvcDtcbiAgICB9O1xuXG4gICAgV09XLnByb3RvdHlwZS5pc1Zpc2libGUgPSBmdW5jdGlvbihib3gpIHtcbiAgICAgIHZhciBib3R0b20sIG9mZnNldCwgdG9wLCB2aWV3Qm90dG9tLCB2aWV3VG9wO1xuICAgICAgb2Zmc2V0ID0gYm94LmdldEF0dHJpYnV0ZSgnZGF0YS13b3ctb2Zmc2V0JykgfHwgdGhpcy5jb25maWcub2Zmc2V0O1xuICAgICAgdmlld1RvcCA9IHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICAgIHZpZXdCb3R0b20gPSB2aWV3VG9wICsgTWF0aC5taW4odGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCwgdGhpcy51dGlsKCkuaW5uZXJIZWlnaHQoKSkgLSBvZmZzZXQ7XG4gICAgICB0b3AgPSB0aGlzLm9mZnNldFRvcChib3gpO1xuICAgICAgYm90dG9tID0gdG9wICsgYm94LmNsaWVudEhlaWdodDtcbiAgICAgIHJldHVybiB0b3AgPD0gdmlld0JvdHRvbSAmJiBib3R0b20gPj0gdmlld1RvcDtcbiAgICB9O1xuXG4gICAgV09XLnByb3RvdHlwZS51dGlsID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdXRpbCAhPSBudWxsID8gdGhpcy5fdXRpbCA6IHRoaXMuX3V0aWwgPSBuZXcgVXRpbCgpO1xuICAgIH07XG5cbiAgICBXT1cucHJvdG90eXBlLmRpc2FibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gIXRoaXMuY29uZmlnLm1vYmlsZSAmJiB0aGlzLnV0aWwoKS5pc01vYmlsZShuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFdPVztcblxuICB9KSgpO1xuXG59KS5jYWxsKHRoaXMpO1xuIl19
